#!/bin/bash
set -e

if [ "$#" -lt 1 ]; then
    echo "Please provide at least one folder path."
    exit 1
fi

for folder_path in "$@"; do
    if [ ! -d "$folder_path" ]; then
        echo "Invalid folder path: $folder_path"
        continue
    fi

    current_datetime=$(date "+%H%M%S-%Y%m%d")
    folder_name="$(basename "$folder_path")"
    output_filename="$folder_name-$current_datetime.zip"

    echo "Processing folder: $folder_path"
    echo "Size: $(du -sh "$folder_path")"

    zip -r "$output_filename" "$folder_path"
    
    # Cleaning up the folder, assuming 'list.txt' should not be deleted
    find "$folder_path" -not -name "$(basename "$folder_path")" -not -name 'list.txt' -not -name '.' -exec rm -rf {} +

    echo "Zip completed for $folder_path at $(date "+%H:%M:%S")"
    echo "File Size: $(du -sh "$output_filename")"
done
